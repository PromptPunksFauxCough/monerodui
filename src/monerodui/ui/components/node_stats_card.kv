<StatItem>:
    orientation: "vertical"
    size_hint_x: 1
    adaptive_height: True
    spacing: "2dp"
    padding: ["4dp", "8dp", "4dp", "8dp"]
    MDLabel:
        text: root.value
        font_style: "Title"
        role: "medium"
        halign: "center"
        adaptive_height: True
        bold: True
        theme_text_color: "Custom"
        text_color: [1, 0.4, 0, 1] if root.is_ok else app.theme_cls.errorColor
    MDLabel:
        text: root.label
        font_style: "Body"
        role: "small"
        halign: "center"
        adaptive_height: True
        theme_text_color: "Custom"
        text_color: [0.6, 0.6, 0.6, 1]

<SmallStatItem>:
    orientation: "vertical"
    size_hint_x: 1
    adaptive_height: True
    spacing: "2dp"
    padding: ["4dp", "4dp", "4dp", "4dp"]
    MDLabel:
        text: root.value
        font_style: "Body"
        role: "large"
        halign: "center"
        adaptive_height: True
        bold: True
        theme_text_color: "Custom"
        text_color: [1, 1, 1, 1]
    MDLabel:
        text: root.label
        font_style: "Label"
        role: "small"
        halign: "center"
        adaptive_height: True
        theme_text_color: "Custom"
        text_color: [0.6, 0.6, 0.6, 1]

<SyncProgressBar>:
    size_hint_y: None
    height: "24dp"
    canvas.before:
        Color:
            rgba: [0.1, 0.1, 0.1, 1]
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(4)]
        Color:
            rgba: [1, 0.4, 0, 1]
        RoundedRectangle:
            pos: self.pos
            size: self.width * root.progress / 100, self.height
            radius: [dp(4)]
    MDLabel:
        text: f"{root.progress:.1f}%" if root.progress < 100 else "Synced"
        halign: "center"
        font_style: "Label"
        role: "large"
        bold: True
        theme_text_color: "Custom"
        text_color: [1, 1, 1, 1]

<UpdateBanner>:
    size_hint_y: None
    height: self.minimum_height
    padding: "12dp"
    spacing: "8dp"
    md_bg_color: [0.8, 0.2, 0.2, 0.2]
    radius: [dp(8)]
    MDIcon:
        icon: "alert-circle"
        theme_text_color: "Custom"
        text_color: [1, 0.3, 0.3, 1]
        pos_hint: {"center_y": 0.5}
    MDBoxLayout:
        orientation: "vertical"
        adaptive_height: True
        spacing: "2dp"
        MDLabel:
            text: "Update Available"
            font_style: "Label"
            role: "large"
            bold: True
            adaptive_height: True
            theme_text_color: "Custom"
            text_color: [1, 0.8, 0.8, 1]
        MDLabel:
            text: root.update_text
            font_style: "Body"
            role: "small"
            adaptive_height: True
            size_hint_y: None
            height: self.texture_size[1]
            theme_text_color: "Custom"
            text_color: [1, 0.8, 0.8, 1]

<VersionBanner>:
    size_hint_y: None
    height: self.minimum_height
    padding: ["12dp", "8dp", "12dp", "8dp"]
    spacing: "8dp"
    md_bg_color: [0.15, 0.15, 0.15, 1]
    radius: [dp(8)]
    MDIcon:
        icon: "information"
        theme_text_color: "Custom"
        text_color: [0.6, 0.6, 0.6, 1]
        pos_hint: {"center_y": 0.5}
    MDLabel:
        text: root.version_text
        font_style: "Body"
        role: "medium"
        adaptive_height: True
        theme_text_color: "Custom"
        text_color: [0.9, 0.9, 0.9, 1]

<OfflineMessage>:
    size_hint_y: None
    height: "64dp"
    padding: "16dp"
    MDLabel:
        text: "Node is not running"
        halign: "center"
        valign: "center"
        theme_text_color: "Custom"
        text_color: [0.6, 0.6, 0.6, 1]

<SectionHeader>:
    size_hint_y: None
    height: "32dp"
    padding: ["8dp", "12dp", "8dp", "4dp"]
    MDLabel:
        text: root.text
        font_style: "Label"
        role: "large"
        adaptive_height: True
        bold: True
        theme_text_color: "Custom"
        text_color: [1, 0.4, 0, 1]

<NodeStatsCard>:
    orientation: "vertical"
    padding: "16dp"
    spacing: "12dp"
    adaptive_height: True
    style: "outlined"
    theme_bg_color: "Custom"
    md_bg_color: 0, 0, 0, 1
    line_color: 0, 0, 0, 0
    
    MDBoxLayout:
        adaptive_height: True
        spacing: "8dp"
        MDLabel:
            text: "Node Statistics"
            font_style: "Title"
            role: "medium"
            adaptive_height: True
            theme_text_color: "Custom"
            text_color: [1, 1, 1, 1]
            adaptive_width: True
        Widget:
        MDLabel:
            text: root.network_text
            font_style: "Label"
            role: "small"
            adaptive_height: True
            halign: "right"
            theme_text_color: "Custom"
            text_color: [1, 0.4, 0, 1]
            opacity: 0 if root.is_offline else 1
            adaptive_width: True
    
    MDDivider:
        size_hint_x: 1
        color: [0.2, 0.2, 0.2, 1]
    
    VersionBanner:
        opacity: 0 if root.is_offline or not root.version_text else 1
        height: self.minimum_height if (not root.is_offline and root.version_text) else "0dp"
        version_text: root.version_text
    
    UpdateBanner:
        id: update_banner
        opacity: 1 if root.update_available else 0
        height: self.minimum_height if root.update_available else "0dp"
        update_text: root.update_text
    
    OfflineMessage:
        opacity: 1 if root.is_offline else 0
        height: "64dp" if root.is_offline else "0dp"
    
    MDBoxLayout:
        orientation: "vertical"
        adaptive_height: True
        spacing: "16dp"
        opacity: 0 if root.is_offline else 1
        size_hint_y: None
        height: self.minimum_height if not root.is_offline else "0dp"
        
        MDBoxLayout:
            orientation: "vertical"
            adaptive_height: True
            spacing: "8dp"
            MDLabel:
                text: root.sync_status_text
                font_style: "Body"
                role: "small"
                adaptive_height: True
                theme_text_color: "Custom"
                text_color: [0.6, 0.6, 0.6, 1]
            SyncProgressBar:
                progress: root.sync_progress
        
        SectionHeader:
            text: "OVERVIEW"
        
        MDBoxLayout:
            adaptive_height: True
            spacing: "4dp"
            StatItem:
                value: root.connections_text
                label: "Connections"
                is_ok: root.has_connections
            StatItem:
                value: root.height_text
                label: "Block Height"
                is_ok: root.is_synced
            StatItem:
                value: root.storage_text
                label: "Free Space"
                is_ok: root.has_storage
        
        SectionHeader:
            text: "NETWORK"
        
        MDBoxLayout:
            adaptive_height: True
            spacing: "4dp"
            SmallStatItem:
                value: root.hashrate_text
                label: "Hashrate"
            SmallStatItem:
                value: root.difficulty_text
                label: "Difficulty"
            SmallStatItem:
                value: root.peers_text
                label: "Known Peers"
        
        SectionHeader:
            text: "BLOCKCHAIN"
        
        MDBoxLayout:
            adaptive_height: True
            spacing: "4dp"
            SmallStatItem:
                value: root.tx_count_text
                label: "Total TXs"
            SmallStatItem:
                value: root.tx_pool_text
                label: "TX Pool"
            SmallStatItem:
                value: root.block_reward_text
                label: "Block Reward"
        
        MDBoxLayout:
            adaptive_height: True
            spacing: "4dp"
            SmallStatItem:
                value: root.fee_text
                label: "Est. Fee (XMR)"
            SmallStatItem:
                value: root.db_size_text
                label: "Database Size"
        
        SectionHeader:
            text: "RESOURCES"
        
        MDBoxLayout:
            adaptive_height: True
            spacing: "4dp"
            SmallStatItem:
                value: root.bandwidth_text
                label: "↓ Down / ↑ Up (MB)"
